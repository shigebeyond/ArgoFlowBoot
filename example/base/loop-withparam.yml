# https://argoproj.github.io/argo-workflows/walk-through/loops/
# 接收json
- wf(loop-withparam):
    - args:
        os-list: | # json
                [
                  { "image": "debian", "tag": "9.1" },
                  { "image": "debian", "tag": "8.9" },
                  { "image": "alpine", "tag": "3.6" },
                  { "image": "ubuntu", "tag": "17.10" }
                ]
    - templates:
        cat-os-release(image,tag):
            container:
              image: $image:$tag
              command: cat /etc/os-release
        main(os-list): # 工作流入口必然是main，要放最后
            steps:
            - - template: cat-os-release({{item.image}},{{item.tag}})
                withParam: $os-list # parameter specifies the list to iterate over

- wf(loop-withparam2):
    - templates:
        gen-number-list(): # 生成随机秒数json Generate a list of numbers in JSON format
            python3.6:
              source: |
                    import json
                    import sys
                    json.dump([i for i in range(1, 4)], sys.stdout)
        sleep(sec): # 睡n秒
            container:
              command: echo sleeping for $sec seconds; sleep $sec; echo done
        main(): # 工作流入口必然是main，要放最后
            steps:
            - - gen-number-list()
              # Iterate over the list of numbers generated by the generate step above
            - - template: sleep({{item}})
                withParam: ${gen-number-list.result}



